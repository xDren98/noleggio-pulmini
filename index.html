<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Imbriani Noleggio</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet" />
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
<style>
body { font-family:'Poppins',sans-serif; max-width:980px; margin:0 auto 60px auto;
  background: url('https://user-gen-media-assets.s3.amazonaws.com/seedream_images/2237bed5-a57b-45f0-ac6f-7941a95c5dd1.png') center center no-repeat fixed;
  background-size:cover; color:#f2f6f8; padding:0 18px 120px 18px; min-height:100vh; position:relative;}
.data-triple { display:flex; gap:7px; width:100%; margin-bottom:12px;}
.data-triple select {flex:1 1 0; font-size:1em; border-radius:9px; border:1.2px solid #c5dae5;background:#fff;color:#123035; padding:9px; margin:0;}
label {display:flex;align-items:center;font-weight:700;gap:10px;font-size:1em;color:#fff;text-shadow:0 0 10px rgba(0,0,0,0.85);margin-bottom: 8px;}
.material-icons {font-size:22px;color:#fcd168;text-shadow:0 2px 8px #1a2549;}
input, button, select {padding:12px;width:100%;box-sizing:border-box;border:1.5px solid #c5dae5;border-radius:14px;font-size:1.13em;transition:border-color 0.35s,box-shadow 0.35s;background:rgba(249,250,251,0.95);color:#184154;font-family: 'Poppins', sans-serif;}
input::placeholder {color:#a7babd;}
input:focus, select:focus {outline:none;border-color:#ffe176;box-shadow:0 0 14px 2px #ffe18699;background:#fff;color:#123035;}
.actions {display: flex;flex-wrap: wrap;gap: 18px;margin-top: 10px;margin-bottom: 6px;}
button {background:#147ba7;color:#fefff7;font-weight:700;border-radius:18px;display:flex;align-items:center;justify-content:center;gap:10px;border:none;cursor:pointer;font-size:1.07em;letter-spacing:0.02em;box-shadow:0 2px 4px #21404760;user-select:none;transition:all 0.4s;padding: 12px 24px;}
button span.material-icons {color:#fffdf5;filter:drop-shadow(0 0 2px #0b2732af);}
button:hover:not(:disabled) {background:linear-gradient(90deg,#fcd168,#ffd966 90%);color:#193242;box-shadow:0 7px 24px #fed68277,0 0 8px #89878760;transform:translateY(-2px) scale(1.03);}
button:disabled {background-color:#c9cbcf;cursor:not-allowed;box-shadow:none;transform:none;color:#90959c;}
.step {display: flex;flex-direction: column;gap: 20px;opacity:0;transform:translateY(20px);transition:opacity 0.48s, transform 0.48s;height:0;overflow:hidden;pointer-events:none;background: rgba(26, 38, 51, 0.52);padding: 22px 16px 16px 16px;border-radius: 18px;}
.step.active {opacity:1;transform:translateY(0);height:auto;pointer-events:all;overflow:visible;}
.autista {background:rgba(240,241,237,0.93);border-radius:13px;border:1.8px solid #bddaff;box-shadow:0 2px 12px #73a7ec4b;padding:18px 24px;margin-top:8px;transition:border-color 0.3s, box-shadow 0.3s;display:flex;flex-direction:column;gap:9px;}
.autista:hover {border-color:#1db7ef;box-shadow:0 0 28px #87c4fd90;}
h3 {font-weight:700;margin-bottom:10px;color:#2690c9;border-bottom:2px solid #ffe176;padding-bottom:4px;}
</style>
</head>
<body>
<header>
  <h1>Imbriani Noleggio</h1>
  <p class="slogan">Dividi i costi, moltiplica il divertimento!</p>
</header>
<main>
  <!-- Tutto come le versioni precedenti: step1, step2, step3, step4, step5 -->
</main>
<script>
const pulmini = [
  { id: "ducato_lungo", nome: "Fiat Ducato (Passo lungo)", targa: "EC787NM" },
  { id: "ducato_corto", nome: "Fiat Ducato (Passo corto)", targa: "DN391FW" },
  { id: "peugeot", nome: "Peugeot Expert Tepee", targa: "DL291XZ" }
];

function convertDateToUSFormat(dateEuro) {
  let parts = dateEuro.split('/');
  if(parts.length !== 3) return '';
  return `${parts[1]}/${parts[0]}/${parts[2]}`;
}
function getData(prefix) {
  const gg = document.getElementById('giorno_' + prefix).value;
  const mm = document.getElementById('mese_' + prefix).value;
  const aa = document.getElementById('anno_' + prefix).value;
  return (gg && mm && aa) ? (gg + '/' + mm + '/' + aa) : '';
}
function getDataAutista(tipo, i) {
  const gg = document.getElementById('giorno_' + tipo + '_' + i).value;
  const mm = document.getElementById('mese_' + tipo + '_' + i).value;
  const aa = document.getElementById('anno_' + tipo + '_' + i).value;
  return (gg && mm && aa) ? (gg + '/' + mm + '/' + aa) : '';
}
function apriModuloPrecompilato() {
  const num = parseInt(document.getElementById('num_autisti').value);
  const dataRitiro = convertDateToUSFormat(getData('ritiro'));
  const oraRitiro = document.getElementById('ora_partenza').value;
  const dataArrivo = convertDateToUSFormat(getData('arrivo'));
  const oraArrivo = document.getElementById('ora_arrivo').value;
  const pulminoId = document.getElementById('scelta_pulmino').value;
  const cellulare = encodeURIComponent(document.getElementById('cellulare').value);
  const pulminoObj = pulmini.find(p => p.id === pulminoId);
  const targaPulmino = pulminoObj ? pulminoObj.targa : "";

  let urlModulo =
    "https://docs.google.com/forms/d/e/1FAIpQLSeakbNHdqxJcfTG90xbTnLnEsmwNWh6q2RZIjtDChiJdhbNhw/viewform?usp=pp_url"
    + `&entry.1499256988=${encodeURIComponent(dataRitiro)}`
    + `&entry.925984482=${encodeURIComponent(dataRitiro)}` // data contratto uguale a data ritiro
    + `&entry.257199041=${encodeURIComponent(oraRitiro)}`
    + `&entry.517585546=${encodeURIComponent(dataArrivo)}`
    + `&entry.917923685=${encodeURIComponent(oraArrivo)}`
    + `&entry.1888774437=${cellulare}`
    + `&entry.1578287722=${encodeURIComponent(targaPulmino)}`;

  const entryFields = [
    { nome: '550823113', data_nascita: '766463607', luogo_nascita: '1735522613', cf: '36844075', comune_residenza: '913323396', via_residenza: '1329485765', civico_residenza: '1349864501', numero_patente: '1885490374', inizio_patente: '525872521', fine_patente: '1864189410' },
    { nome: '1236551634', data_nascita: '503259772', luogo_nascita: '1977818551', cf: '1883324084', comune_residenza: '2118103863', via_residenza: '805763990', civico_residenza: '568892376', numero_patente: '124831667', inizio_patente: '657885946', fine_patente: '850104184' },
    { nome: '3164128', data_nascita: '1896520037', luogo_nascita: '1923148193', cf: '2061435678', comune_residenza: '767994785', via_residenza: '1335171224', civico_residenza: '1926018707', numero_patente: '1750806014', inizio_patente: '1084842503', fine_patente: '965705170' }
  ];

  for (let i = 0; i < num; i++) {
    urlModulo += `&entry.${entryFields[i].nome}=${encodeURIComponent(document.getElementById('nome_cognome_' + (i + 1)).value)}`
      + `&entry.${entryFields[i].data_nascita}=${encodeURIComponent(convertDateToUSFormat(getDataAutista('nascita', i+1)))}`
      + `&entry.${entryFields[i].luogo_nascita}=${encodeURIComponent(document.getElementById('luogo_nascita_' + (i + 1)).value)}`
      + `&entry.${entryFields[i].inizio_patente}=${encodeURIComponent(convertDateToUSFormat(getDataAutista('inizio_validita_patente', i+1)))}`
      + `&entry.${entryFields[i].fine_patente}=${encodeURIComponent(convertDateToUSFormat(getDataAutista('fine_validita_patente', i+1)))}`
      + `&entry.${entryFields[i].cf}=${encodeURIComponent(document.getElementById('codice_fiscale_' + (i + 1)).value)}`
      + `&entry.${entryFields[i].comune_residenza}=${encodeURIComponent(document.getElementById('comune_residenza_' + (i + 1)).value)}`
      + `&entry.${entryFields[i].via_residenza}=${encodeURIComponent(document.getElementById('via_residenza_' + (i + 1)).value)}`
      + `&entry.${entryFields[i].civico_residenza}=${encodeURIComponent(document.getElementById('civico_residenza_' + (i + 1)).value)}`
      + `&entry.${entryFields[i].numero_patente}=${encodeURIComponent(document.getElementById('numero_patente_' + (i + 1)).value)}`;
  }

  window.open(urlModulo, '_blank');
}

// Tutte le altre funzioni come step wizard, mostraModuliAutisti, popolaTendineData rimangono uguali

</script>
</body>
</html>
